<!DOCTYPE html>
<html lang="en">
  <head>
    <style>
      body {
        margin: 0;
        background-color: black;
      }
      canvas {
        display: block;
        max-width: 1920px;
        margin: auto;
      }
    </style>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://pixijs.download/release/pixi.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js"></script>
    <script src="/node_modules/pixi-filters/dist/browser/pixi-filters.js"></script>
    <script>
      WebFont.load({
        google: {
          families: ["Sigmar", "Share Tech Mono" ],
        },
        active: (e) => {
          console.log("font loaded!");
        },
      });
    </script>
    <title>BIT-MINER</title>
  </head>
  <body>
    <script>
      //game variables
      let hasPower = true;

      const app = new PIXI.Application({
        background: "#000",
        height: window.innerHeight,
        width: window.innerWidth,
      });

      document.body.appendChild(app.view);

      const bgSprite = PIXI.Sprite.from(
        "assets/images/background-server-room.jpg"
      );
      bgSprite.width = app.screen.width;
      bgSprite.height = app.screen.height;

      // Add the sprite to the stage as the first child
      app.stage.addChildAt(bgSprite, 0);

      //title
      const titleContainer = new PIXI.Container();
      const gameTitle = new PIXI.Text("BIT-MINER", {
        fontSize: 64,
        fill: 0xffffff,
        fontFamily: "Sigmar",
        textAlign: "center",
        dropShadow: true,
        dropShadowColor: "#51D5FF",
        dropShadowBlur: 16,
        padding: 20,
      });
      gameTitle.anchor.set(0.5);
      gameTitle.position.set(
        titleContainer.width / 2,
        titleContainer.height / 2
      );

      titleContainer.position.set(app.view.width / 2, 80);
      titleContainer.addChild(gameTitle);
      app.stage.addChild(titleContainer);

      //background rack
      const rackContainer = new PIXI.Container();
      rackContainer.width = 797;
      rackContainer.height = 721;
      rackContainer.zIndex = 1;
      rackContainer.pivot.set(0.5, 1);
      rackContainer.position.set(
        app.view.width / 2 - 797 / 2,
        app.view.height - 721
      );

      let rackOffSprite = PIXI.Sprite.from("assets/images/rack off.png");
      rackOffSprite.width = 797;
      rackOffSprite.height = 721;
      //rackContainer;

      let rackOnSprite = PIXI.Sprite.from("assets/images/rack on.png");
      rackOffSprite.width = 797;
      rackOffSprite.height = 721;
      
      app.stage.addChild(rackContainer);

      // Add the sprite to the stage as the first child
      setRackState();

      //game display
      const gameDisplayMonitor = new PIXI.Graphics();
      gameDisplayMonitor.beginFill("#000000");
      gameDisplayMonitor.drawRoundedRect(0, 0, 534, 387, 21);
      gameDisplayMonitor.endFill();
      gameDisplayMonitor.position.set(
        rackContainer.width / 2 - gameDisplayMonitor.width / 2,
        150
      );
      gameDisplayMonitor.filters = [
        new PIXI.filters.DropShadowFilter({
          distance: 10,
          blur: 23,
          alpha: 0.9,
        }),
      ];

      rackContainer.addChild(gameDisplayMonitor);

      //controls container
      const controlsContainer = new PIXI.Container();
      const controlsPanel = new PIXI.Graphics();
      controlsPanel.lineStyle(2, 0x25EC5D, 0.4);
      controlsPanel.beginFill(0x000000, 0.5);
      controlsPanel.drawRect(0,0,764, 170);
      controlsPanel.endFill();
      controlsPanel.zIndex = 3;
      controlsContainer.addChild(controlsPanel);
      controlsContainer.position.set( (app.view.width /2) - (controlsContainer.width/2) , app.view.height - (controlsContainer.height + 20));
      app.stage.addChild(controlsContainer);

      //purchase power button
      const purchasePowerContainer = new PIXI.Container();
      const purchasePowerSprite = PIXI.Sprite.from("assets/images/mine-button.png");
      purchasePowerSprite.width = 189;
      purchasePowerSprite.height = 186;
      purchasePowerContainer.addChild(purchasePowerSprite);
      purchasePowerSprite.position.y = -30;
      controlsContainer.addChild(purchasePowerContainer);
      purchasePowerSprite.interactive = true;
      purchasePowerSprite.cursor = 'pointer';
      purchasePowerSprite.addListener('pointerdown', () => {
        console.log(hasPower);
        hasPower = !hasPower;
        setRackState();

    });

      const purchaseButtonText = new PIXI.Text("PURCHASE VOLTS", {
        fontSize: 24,
        fill: 0xC7D4FF,
        fontFamily: "Share Tech Mono",
      });
      purchaseButtonText.position.set(0, purchasePowerContainer.height - (purchaseButtonText.height * 2));
    //   purchaseButtonText.anchor.set(0.5);
    //   purchaseButtonText.position.set(
    //     purchasePowerContainer.width / 2,
    //     purchasePowerContainer.height / 2
    //   );
      purchasePowerContainer.addChild(purchaseButtonText);


      //mine button ( a.k.a. spin)

      //game status text

      function setRackState() {
        if (!hasPower) {
            rackContainer.removeChild(rackOnSprite);
        rackContainer.addChild(rackOffSprite);
      } else {
        rackContainer.removeChild(rackOffSprite);
        rackContainer.addChild(rackOnSprite);
      }
    //   app.stage.addChild(rackContainer);
      }
      
    </script>
  </body>
</html>
